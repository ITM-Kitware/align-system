# @package _global_
defaults:
  - /attribute@adm.personal_safety: personal_safety
  - /attribute@adm.search_or_stay: search_or_stay
  - override /adm: pipeline_kaleido
  - override /interface: ta3

interface:
  session_type: adept
  training_session: full
  username: "pipeline_kaleido_test"

adm:
  step_definitions:
    kaleido:
      prompt_template:
        _target_: align_system.prompt_engineering.outlines_prompts.KaleidoDefaultITMPh2Prompt

      kdma_descriptions_map:
        Personal Safety:
          name: Personal Safety
          description: Tendency to hold back from moving to treat a patient when that requires risking exposure to enemy fire, waiting rather than immediately moving to treat the patient
          vrd: Value
        Search or Stay:
          name: Search or Stay
          description: Tendency to move on from their current patient in order to treat or search for another patient
          vrd: Value
  
  attribute_definitions:
    Personal Safety: ${adm.personal_safety}
    Search or Stay: ${adm.search_or_stay}

  instance:
    steps:
    # Reference the step instances we want to use in order
    - ${ref:adm.step_definitions.format_choices}
    - ${ref:adm.step_definitions.kaleido}
    - ${ref:adm.step_definitions.rename_kaleido_relevance_variables}
    - ${ref:adm.step_definitions.scalar_alignment}
    - ${ref:adm.step_definitions.justification_from_reasonings}
    # - ${ref:adm.step_definitions.action_parameter_completion}
    - ${ref:adm.step_definitions.ensure_chosen_action}
    - ${ref:adm.step_definitions.populate_choice_info}

    
force_determinism: true
align_to_target: true
